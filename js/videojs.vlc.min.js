videojs.Vlc=videojs.MediaTechController.extend({init:function(e,t,i){videojs.MediaTechController.call(this,e,t,i);var r=t.source,o=e.id()+"_vlc_api",n=this;this.player_=e;var s=videojs.util.mergeOptions({animationatstart:"true",transparentatstart:"true",windowless:"true",controls:"false",bgcolor:"#000000",autostart:e.options.autoplay?"true":"false",allowfullscreen:"true",text:"Video.js VLC plug-in"},t.params);r&&(s.source=r.src,this.ready(function(){this.setSrc(r.src)}));var l=videojs.util.mergeOptions({id:o,name:o,"class":"vjs-tech"},t.attributes),a=t.parentEl,c=this.el_=videojs.Component.prototype.createEl("div",{id:e.id()+"temp_vlc"});a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c),t.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(t.startTime)}),e.ready(function(){}),this.el_=videojs.Vlc.embed(c,s,l),this.el_.tech=this,videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerOpening",function(){e.trigger("loadstart")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerBuffering",function(){e.trigger("loadeddata"),e.trigger("volumechange")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerPlaying",function(){e.trigger("play"),e.trigger("playing")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerPaused",function(){e.trigger("pause")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerStopped",function(){e.trigger("pause"),e.trigger("ended")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerEndReached",function(){e.trigger("pause"),e.trigger("ended")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerTimeChanged",function(){e.trigger("timeupdate")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerPositionChanged",function(){e.trigger("progress")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerLengthChanged",function(){e.trigger("durationchange")}),setTimeout(function(){n.triggerReady()},100)}}),videojs.Vlc.prototype.params=[],videojs.Vlc.prototype.dispose=function(){this.el_&&this.el_.parentNode.removeChild(this.el_),videojs.MediaTechController.prototype.dispose.call(this)},videojs.Vlc.prototype.src=function(e){return void 0===e?this.currentSrc():this.setSrc(e)},videojs.Vlc.prototype.setSrc=function(e){e=videojs.Vlc.getAbsoluteURL(e),this.getApi().playlist.items.clear(),this.getApi().playlist.add(e)},videojs.Vlc.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.getApi().playlist.items[this.getApi().playlist.currentItem]},videojs.Vlc.prototype.load=function(){},videojs.Vlc.prototype.poster=function(){this.el_.vjs_getProperty("poster")},videojs.Vlc.prototype.setPoster=function(){},videojs.Vlc.prototype.play=function(){this.getApi().playlist.play()},videojs.Vlc.prototype.ended=function(){var e=this.getApi().input.state;return 6===e||7===e},videojs.Vlc.prototype.pause=function(){this.getApi().playlist.pause()},videojs.Vlc.prototype.paused=function(){var e=this.getApi().input.state;return 4===e||6===e},videojs.Vlc.prototype.currentTime=function(){return this.getApi().input.time/1e3},videojs.Vlc.prototype.setCurrentTime=function(e){this.getApi().input.time=1e3*e},videojs.Vlc.prototype.duration=function(){return this.getApi().input.length/1e3},videojs.Vlc.prototype.buffered=function(){return[]},videojs.Vlc.prototype.volume=function(){return this.getApi().audio.volume/100},videojs.Vlc.prototype.setVolume=function(e){e&&(this.getApi().audio.volume=100*e)},videojs.Vlc.prototype.muted=function(){return this.getApi().audio.mute},videojs.Vlc.prototype.setMuted=function(e){this.getApi().audio.mute.mute=e},videojs.Vlc.prototype.supportsFullScreen=function(){return!0},videojs.Vlc.prototype.enterFullScreen=function(){this.getApi().video.fullscreen=!0,this.player_.trigger("fullscreenchange")},videojs.Vlc.prototype.exitFullScreen=function(){this.getApi().video.fullscreen=!1,this.player_.trigger("fullscreenchange")},videojs.Vlc.prototype.getApi=function(){return this.el_},videojs.Vlc.registerEvent=function(e,t,i){e&&(e.attachEvent?e.attachEvent(t,i):e.addEventListener?e.addEventListener(t,i,!1):e["on"+t]=i)},videojs.Vlc.unregisterEvent=function(e,t,i){e&&(e.detachEvent?e.detachEvent(t,i):e.removeEventListener?e.removeEventListener(t,i,!1):e["on"+t]=null)},videojs.Vlc.embed=function(e,t,i){{var r=videojs.Vlc.getEmbedCode(t,i),o=videojs.Component.prototype.createEl("div",{innerHTML:r}).childNodes[0];e.parentNode}return e.parentNode.replaceChild(o,e),o},videojs.Vlc.getEmbedCode=function(e,t){var i,r,o="",n="";if(window.ActiveXObject){i='<object classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" codebase="http://download.videolan.org/pub/videolan/vlc/last/win32/axvlc.cab" ',t=videojs.util.mergeOptions({width:"100%",height:"100%",tabindex:"-1"},t);for(r in e)o+='<param name="'+r+'" value="'+e[r]+'" />';for(r in t)n+=r+'="'+t[r]+'" ';return i+n+">"+o+"</object>"}i='<embed type="application/x-vlc-plugin" pluginspage="http://www.videolan.org" ',t=videojs.util.mergeOptions(e,t);for(r in t)n+=r+'="'+t[r]+'" ';return i+n+"/>"},videojs.Vlc.getAbsoluteURL=function(e){return e.match(/^https?:\/\//)||(e=videojs.Component.prototype.createEl("div",{innerHTML:'<a href="'+e+'">x</a>'}).firstChild.href),e},videojs.Vlc.isSupported=function(){var e;if(window.ActiveXObject)try{e=new window.ActiveXObject("VideoLAN.VLCPlugin.2")}catch(t){}else if(navigator.plugins&&navigator.mimeTypes.length>0){var i="VLC";if(navigator.plugins&&navigator.plugins.length>0)for(var r=0;r<navigator.plugins.length;++r)if(-1!==navigator.plugins[r].name.indexOf(i))return e=navigator.plugins[r],!0}return e?!0:!1},videojs.Vlc.canPlaySource=function(){return"maybe"};